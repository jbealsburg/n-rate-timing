<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-22">

<title>N-rate Timing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="nrate_draft_files/libs/clipboard/clipboard.min.js"></script>
<script src="nrate_draft_files/libs/quarto-html/quarto.js"></script>
<script src="nrate_draft_files/libs/quarto-html/popper.min.js"></script>
<script src="nrate_draft_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="nrate_draft_files/libs/quarto-html/anchor.min.js"></script>
<link href="nrate_draft_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="nrate_draft_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="nrate_draft_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="nrate_draft_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="nrate_draft_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">N-rate Timing</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="to-do" class="level1">
<h1>To do</h1>
<p>Distill brainstorming done in the EDA scripts, report.Rmd and Dominics word doc into a singular first draft.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<div class="cell">

</div>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
</section>
<section id="lodging" class="level1">
<h1>Lodging</h1>
<p>Understanding lodging is not a primary objective of this experiment, this data was only collected as a covariate if there happened to be a lot of lodging.</p>
<p>In general, if lodging is above 6, the yield data is questionable.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Only R100 and V17 showed lodging, and only R100 had severe lodging to the point where the yield data probably is not very accurate.</p>
<section id="r100" class="level2">
<h2 class="anchored" data-anchor-id="r100">R100</h2>
<p>R100 only had N applied in the second and third year.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lodging only occurred in the stands third year of production.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We observe a general increase in lodging as nitrogen rate increases. We fit a logistic curve since lodging cannot be greater than 10 and we expect as we increase N rate more lodging will get closer to 10. This curve is obviously not perfect.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at treatment timing with N rate, I see a bit more red dots (fall) with lower lodging, but it’s messy. Sprint split has some of the most lodging, but also an outlier at near 150 kg N ha where there was no lodging</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we are fitting a logistic regression with a y intercept of zero because we assume at 0N there is no lodging (as shown with control plots) and that lodging score will increase as nitrogen rate increases but that lodging will never exceed 10. The takeaway from this figure is that there is no lodging at 0N and that you see less lodging when you apply in fall and more when you apply in spring and summer.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is a funkier way to look at this data based on how I organized the data and it is confusing so may not be worth trying to interpret.. Every lodging observation has a corresponding amount of N applied in fall, spring and summer. All of the spring plots, for example, also are plots where no N was applied in the fall. So within each of the timings (fall, spring or summer), the entire lodging dataset is represented. This also means the lodging dataset is duplicated 3 times when we do this. I am not sure if this is ok, but this is how I think this can be interpreted.</p>
<p>With more N there is more lodging, but we also see more lodging when the N is applied closer to harvest.</p>
<table class="table">
<caption>Linear regression parameters for lodging response to nitrogen timing</caption>
<thead>
<tr class="header">
<th>Timing of N</th>
<th>m (lodging ~ m*nrate + b)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fall</td>
<td>-0.002</td>
</tr>
<tr class="even">
<td>spring</td>
<td>0.025</td>
</tr>
<tr class="odd">
<td>summer</td>
<td>0.041</td>
</tr>
</tbody>
</table>
<div class="cell">

</div>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<p>When we fit logistic curves, it looked like the lodging was lowest in the control and fall plots. Let’s see if this is true.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: lodging
                        Df  Sum Sq Mean Sq  F value Pr(&gt;F)    
log(n.total + 1)         1 3109.08 3109.08 428.8900 &lt;2e-16 ***
timing                   5   19.87    3.97   0.5481 0.7388    
log(n.total + 1):timing  3   18.84    6.28   0.8664 0.4655    
Residuals               45  326.21    7.25                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We cannot reject Ho that timing has an impact on lodging.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> timing       emmean    SE df lower.CL upper.CL .group
 Control       0.333 1.559 49    -2.80     3.47  1    
 Fall          6.500 0.779 49     4.93     8.07   2   
 Fall Split    8.083 0.779 49     6.52     9.65   2   
 Spring Split  8.167 0.779 49     6.60     9.73   2   
 Spring        8.267 0.697 49     6.87     9.67   2   

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 5 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Obviously, if we look just at timing then the control plots have less lodging than the rest of the plots receiving N. Takeaway here is that lodging is correlated with increases in N, but we cannot reject the Ho that timing does not have an impact. It looks like fall applied N had less impact on lodging, but we cannot reject Ho.</p>
<p>Based on analysis, we are better off just fitting a general curve to lodging by nrate, we will need to do more analysis to find the best curve with the most fitting relationship.</p>
</section>
</section>
<section id="v17" class="level2">
<h2 class="anchored" data-anchor-id="v17">V17</h2>
<p>Lodging is below threshold of 6, meaning we think this yield data is still good.</p>
<p>We are just looking to see if similar trends to R100 where applying more N leads to more lodging and where applying N closer to harvest correlates with more lodging</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lodging only occurred in the stands second year of production. This could’ve just been a harvest timing issue, but harvest was 3Aug so unlikely.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Not a strong relationship between N rate and lodging. There is a good amount of lodging in control. Nothing to see here.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="plant-height" class="level1">
<h1>Plant height</h1>
<p>Plant height is also not a measurement of primary interest.</p>
<p>We are curious to what extent plant height relates to lodging in R100</p>
<p>We are curious more broadly how plant height was distributed across experiments.</p>
<section id="r100---third-year-with-lodging-only" class="level2">
<h2 class="anchored" data-anchor-id="r100---third-year-with-lodging-only">R100 - third year with lodging only</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We observe an overall trend of decreasing plant height as N rate increases.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: height
          Df   Sum Sq  Mean Sq F value   Pr(&gt;F)   
n.total    1 0.049647 0.049647 10.7931 0.001908 **
timing     4 0.037013 0.009253  2.0116 0.107787   
Residuals 48 0.220797 0.004600                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Cannot reject Ho that timing has no effect on the effect of n rate on plant height</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have learned from R100 in it’s third stand age that as nrate increases, there is an increase in lodging and a decrease in plant height.</p>
<p>Let’s see if they’re correlated</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           lodging     height
lodging  1.0000000 -0.4993655
height  -0.4993655  1.0000000</code></pre>
</div>
</div>
<p>We observe a pearson correlation coefficient of -0.5 between height and lodging. This is considered between a moderate and strong correlation.</p>
</section>
<section id="beyond-r100" class="level2">
<h2 class="anchored" data-anchor-id="beyond-r100">Beyond R100</h2>
<p>We only have height data for V17 in stand ages 2 and 3 besides the R100 in stand age 3.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>alright, we only have two sites with plant height data</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: height
          Df   Sum Sq  Mean Sq F value Pr(&gt;F)
n.total    1 0.000056 0.000056  0.0092  0.924
Residuals 30 0.181829 0.006061               </code></pre>
</div>
</div>
<p>We cannot reject Ho that plant height is the same across n rates</p>
</section>
</section>
<section id="yield" class="level1">
<h1>Yield</h1>
<section id="cumulative" class="level2">
<h2 class="anchored" data-anchor-id="cumulative">cumulative</h2>
<p>Cumulative yield of kernza stands after 3 years of N fertilizer (V17 and Staples)</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="quadratic-model" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-model">quadratic model</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000.713</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1020.782</code></pre>
</div>
</div>
<p>Ok, so there is an effect of cumulative N when modelled quadratically versus linear</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield.cum
                       Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
poly(cumn, 2)           2 2011131 1005565 12.0239 0.0001701 ***
location                1 2181936 2181936 26.0901 2.065e-05 ***
timing                  2  284394  142197  1.7003 0.2009473    
poly(cumn, 2):location  2  114253   57126  0.6831 0.5132778    
poly(cumn, 2):timing    3  186149   62050  0.7419 0.5360498    
location:timing         2   71804   35902  0.4293 0.6551831    
Residuals              28 2341662   83631                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now that I’m modeling quadratically, we can reject the Ho there is no relationship between nitrogen rate and yield, but we cannot reject Ho that timing doesn’t matter</p>
</section>
</section>
<section id="mixed-effect-model" class="level2">
<h2 class="anchored" data-anchor-id="mixed-effect-model">mixed effect model</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: yield.cum
                                Chisq Df Pr(&gt;Chisq)    
poly(cumn, 2)                  0.5868  2     0.7457    
location                      27.2054  1  1.829e-07 ***
timing                         4.0312  2     0.1332    
poly(cumn, 2):location         1.1353  2     0.5669    
poly(cumn, 2):timing           2.8742  3     0.4114    
location:timing                0.8907  2     0.6406    
poly(cumn, 2):location:timing          0               
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The best model I can create (lowest AIC) finds a difference in cumulative yield by location, but not an effect of nrate, timing or an interaction.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="nrate_draft_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>TAKEAWAY: We applied N at differing rates and timings over 3 years at two locations. We cannot reject the Ho that the amount of N and the timing of N do not impact the cumulative yield over the 3 years. I would say our data suggests a quadratic or logarithmic relationship at around 60 kg N ha per year does not result in noticeably greater grain yields.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>